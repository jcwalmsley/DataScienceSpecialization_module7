mpgcomp <- c(Wa,W0)
names(mpgcomp) <- c("Weighted","UnWeighted")
mpgcomp
library(UsingR); data("mtcars")
g <- ggplot(mtcars, aes(x = value, fill = variable))
g <- g + geom_histogram(colour = "black", binwidth=1)
g <- g + facet_grid(. ~ variable)
g
g <- ggplot(mtcars, aes(x = value, fill = cyl))
g <- g + geom_histogram(colour = "black", binwidth=1)
g <- g + facet_grid(. ~ variable)
g
g <- ggplot(mtcars, aes(x = cyl, fill = mpg))
g <- g + geom_histogram(colour = "black", binwidth=1)
g <- g + facet_grid(. ~ variable)
g
library(ggplot)
g <- ggplot(mtcars, aes(x = cyl)) + geom_histogram(fill = "orange", color = "\black", binwidth = 1)
g <- g = geom_vline(xintercept = mean(mtcars$mpg). size = 3)
g
library(ggplot)
library(ggplot2)
g <- ggplot(mtcars, aes(x = cyl)) + geom_histogram(fill = "orange", color = "\black", binwidth = 1)
g <- g = geom_vline(xintercept = mean(mtcars$mpg). size = 3)
g
#
g <- ggplot(mtcars, aes(x = mpg)) + geom_histogram(fill = "orange", color = "\black", binwidth = 1)
g <- g = geom_vline(xintercept = mean(mtcars$mpg). size = 3)
g
g <- ggplot(mtcars, aes(x = mpg)) + geom_histogram(fill = "orange", color = "black", binwidth = 1)
g <- g = geom_vline(xintercept = mean(mtcars$mpg). size = 3)
g
#
library(ggplot2)
g <- ggplot(mtcars, aes(x = mpg, y = cyl)) + geom_histogram(fill = "orange", color = "black", binwidth = 1)
g <- g = geom_vline(xintercept = mean(mtcars$mpg). size = 3)
g
g <- g = geom_vline(xintercept = mean(mpg). size = 3)
g
g <- g = geom_vline(xintercept = mean(mpg), size = 3)
g
library(ggplot2)
g <- ggplot(mtcars, aes(x = mpg, y = cyl)) + geom_histogram(fill = "orange", color = "black", binwidth = 1)
g <- g = geom_vline(xintercept = mean(mpg), size = 3)
g
g <- g = geom_vline(xintercept = mean(mtcars$mpg), size = 3)
g
g <- ggplot(mtcars, aes(x = mpg, y = cyl)) + geom_histogram(fill = "orange", color = "black", binwidth = 1)
g <- g = geom_vline(xintercept = mean(mtcars$mpg), size = 3)
g
plot(hist(fwt))
plot(hist(fwt$model))
hist(mpgcomp)
hist(mpgcomp$mpg, mtcars$cyl)
hist(cyl)
ggplot(mtcars, aes(x = cyl, y = mpg)) + geom_point()
coef(f2)[3]
f2 <- lm(mpg ~ factor(cyl) + wt, data = mtcars)
coef(f2)[3]
f1 <- lm(mpg ~ factor(cyl) + wt, data = mtcars)
coef(f1)[3]
f1 <- lm(mpg ~ factor(cyl) + wt, data = mtcars)
coef(f1)[3]
f2 <- lm(mpg ~ factor(cyl) + wt, data = mtcars)
coef(f2)[3]
head(mtcars)
f2 <- lm(mpg ~ factor(cyl) + wt, data = mtcars)
wadded <- coef(f2)[3]
f0 <- lm(mpg ~ factor(cyl), data = mtcars)
wrem <- coef(f0)[3]
mpgcomp <- c(wadded,wremoved)
wremoved <- coef(f0)[3]
mpgcomp <- c(wadded,wremoved)
names(mpgcomp) <- c("Weighted","UnWeighted")
mpgcomp
ggplot(mtcars, aes(x = "Weighted", y = "Unweighted")) + geom_point()
mpgcomp
row.names(mpgcomp) <- "8cylinder"
row.names(mpgcomp) <- c("8cylinder")
wremoved <- coef(f0)[3]
mpgdiff <- c(wadded,wremoved)
names(mpgdiff) <- c("Weighted","UnWeighted")
row.names(mpgdiff) <- c("8cylinder")
mpgdiff <- c(wadded,wremoved, row.names("8cylinder"))
names(mpgdiff) <- c("Weighted","UnWeighted")
row.names(mpgdiff) <- c("8cylinder")
mpgdiff
mpgdiff <- c(wadded,wremoved, row.names("8cylinder"))
names(mpgdiff) <- c("Weighted","UnWeighted")
mpgdiff
#
mpgdiff <- c(wadded,wremoved, row.names("8_cyl"))
names(mpgdiff) <- c("Weighted","UnWeighted")
mpgdiff
??rownames
rownames(mpgdiff) <- c("8cyl")
mpgdiff
names(mpgdiff) <- c("Weighted","UnWeighted", rownames("8cyl"))
mpgdiff
names(mpgdiff) <- c("Weighted","UnWeighted", row.names("8cyl"))
mpgdiff
names(mpgdiff) <- data.frame("Weighted","UnWeighted", row.names("8cyl"))
mpgdiff
mpgdiff <- c(wadded,wremoved)
mpgdiff
mpgdiff <- c(wadded,wremoved)
mpgdiff <- c(weughtincluded,weightremoved)
mpgdiff
data("mtcars")
head(mtcars)
f1 <- lm(mpg ~ factor(cyl) + wt, data = mtcars)
data("mtcars")
head(mtcars)
f1 <- lm(mpg ~ factor(cyl) + wt, data = mtcars)
coef(f1)[3]
data("mtcars")
head(mtcars)
f2 <- lm(mpg ~ factor(cyl) + wt, data = mtcars)
weightincluded <- coef(f2)[3]
f0 <- lm(mpg ~ factor(cyl), data = mtcars)
weightremoved <- coef(f0)[3]
mpgdiff <- c(weughtincluded,weightremoved)
mpgdiff <- c(weightincluded,weightremoved)
mpgdiff
mpgdiff <- data.frame(weightincluded,weightremoved, row.names = "8cyl")
mpgdiff
plot(mpgdiff$weightincluded,mpgdiff$weightremoved)
hist(mpgdiff)
plot.default(mpgdiff)
plot(mpgdiff)
plot(c(f2,f0))
f2 <- lm(mpg ~ factor(cyl) + wt, data = mtcars)
f2
f0 <- lm(mpg ~ I(cyl=8), data = mtcars)
f0 <- lm(mpg ~ I(mpg$cyl=8), data = mtcars)
f0 <- lm(mpg ~ cyl=8, data = mtcars)
f0 <- lm(mpg ~ (cyl=8), data = mtcars)
f0 <- lm(mpg ~ I(cyl=8), data = mtcars)
f0 <- lm(mpg ~ I(cyl="8"), data = mtcars)
f0 <- lm(mpg ~ cyl="8", data = mtcars)
f0 <- lm(mpg ~ factor(cyl), data = mtcars)
weightremoved <- coef(f0)[3]
mpgdiff <- c(weightincluded,weightremoved)
mpgdiff <- data.frame(weightincluded,weightremoved, row.names = "8cyl")
plot(c(f2,f0))
plot(mpgdiff)
mpgdiff <- data.frame(weightincluded,weightremoved, row.names = "8cyl")
mpgdiff
weightincluded <- coef(f2)[3]
weightincluded
weightremoved
mpgdiff <- c(weightincluded,weightremoved)
mpgdiff <- data.frame(weightincluded,weightremoved, row.names = "8cyl")
mpgdiff
data("mtcars")
head(mtcars)
f2 <- lm(mpg ~ factor(cyl) + wt, data = mtcars)
adjusted <- coef(f2)[3]
adjusted
f0 <- lm(mpg ~ factor(cyl), data = mtcars)
unadjusted <- coef(f0)[3]
unadjusted
mpgdiff <- c(adjusted,unadjusted)
mpgdiff <- data.frame(adjusted,unadjusted, row.names = "8cyl")
mpgdiff
adjusted <- coef(f2)[1][3]
adjusted
adjusted <- coef(f2)[1,3]
adjusted <- coef(f2)[c(1,3)]
adjusted
unadjusted <- coef(f0)[c(1,3)]
unadjusted
mpgdiff <- c(adjusted,unadjusted)
mpgdiff <- data.frame(adjusted,unadjusted, row.names = "modelf2","modelf0")
mpgdiff <- data.frame(adjusted,unadjusted, row.names = c("modelf2","modelf0"))
mpgdiff
mpgdiff <- data.frame(adjusted,unadjusted, row.names = c("4cyl","8cyl"))
mpgdiff
mpgdiff <- data.frame(adjusted,unadjusted, row.names = c("mpg-4cyl","mpg-8cyl-diff"))
mpgdiff
mpgdiff <- data.frame(adjusted,unadjusted, row.names = c("est-mpg-4cyl","mpg-8cyl-diff"))
mpgdiff
mpgdiff <- data.frame(adjusted,unadjusted, row.names = c("est-mpg-4cyl","change-mpg-8cyl"))
mpgdiff
mpgdiff <- data.frame(adjusted,unadjusted, row.names = c("4cyl-est-mpg","8cyl-change-mpg"))
mpgdiff
plot(mpgdiff)
hist(mpgdiff)
g <- ggplot(mpgdiff, aes(x = mpg, y = cyl)
g
g <- ggplot(mpgdiff, aes(x = mpg, y = cyl))
g
plot(y ~ x)
plot(y, x)
mpgdiff
require(ggplot2)
g <- ggplot(data = mpgdiff, aes(y = mpg, x = cyl, fill = mpg)
g <- g + geom_curve(colour = "black". size = 2)
g <- g + xlab("No.Cyl") + ylab("MPG")
g
g <- ggplot(data = mpgdiff, aes(y = y, x = x, fill = mpg)
g <- g + geom_curve(colour = "black". size = 2)
g <- g + xlab("No.Cyl") + ylab("MPG")
g
require(ggplot2)
g <- ggplot(data = mpgdiff, aes(y = y, x = x, fill = mpg)
g <- g + geom_curve(colour = "black". size = 2)
g <- g + xlab("No.Cyl") + ylab("MPG")
g
mpgdiff
rm(ls =(ls))
rm(list =(ls))
rm(list =ls())
data("mtcars")
head(mtcars)
f1 <- lm(mpg ~ factor(cyl) + wt, data = mtcars)
coef(f1)[3]
data("mtcars")
head(mtcars)
f1 <- lm(mpg ~ factor(cyl) + wt, data = mtcars)
summary(f1)
f2 <- lm(mpg ~ factor(cyl) * wt, data = mtcars)
summarize(f2)
summary(f2)
anova(f1,f2)
head(lm(mpg ~ I(wt * 0.5) + factor(cyl), data = mtcars)
head(lm(mpg ~ I(wt * 0.5) + factor(cyl), data = mtcars))
f3 <- (lm(mpg ~ I(wt * 0.5) + factor(cyl), data = mtcars))
head(f3)
str(mtcars)
attributes(mtcars)
summarize(mtcars)
summary(mtcars)
??mtcars
require(graphics)
pairs(mtcars, main = "mtcars data")
coplot(mpg ~ disp | as.factor(cyl), data = mtcars,
panel = panel.smooth, rows = 1)
coplot(mpg ~ disp | as.factor(cyl), data = mtcars,
panel = panel.smooth, rows = 1)
coplot(mpg ~ wt | as.factor(cyl), data = mtcars,
panel = panel.smooth, rows = 1)
coplot(mpg ~ I(wt*0.5) | as.factor(cyl), data = mtcars,
panel = panel.smooth, rows = 1)
??mtcars
f5 <- lm(y ~ x)
hatvalues(f5)
f5 <- lm(y ~ x)
hatvalues(f5)
#
x <- c(0.586, 0.166, -0.042, -0.614, 11.72)
y <- c(0.549, -0.026, -0.127, -0.751, 1.344)
f5 <- lm(y ~ x)
hatvalues(f5)
maxhv <- max(hatvalues(f5))
maxhv
maxhv <- hatvalues(f5)[which.max(hatvalues(f5))]
maxhv
x <- c(0.586, 0.166, -0.042, -0.614, 11.72)
y <- c(0.549, -0.026, -0.127, -0.751, 1.344)
f4 <- lm(y ~ x)
hatvalues(f4)
maxhv <- hatvalues(f4)[which.max(hatvalues(f4))]
maxhv
hatvalues(f4)
maxhv <- hatvalues(f4)[which.max(hatvalues(f4))]
maxhv
plot(x, y, pch=19)
abline(f4, col="red")
fit5 <- lm(y[-which.max(hatvalues(f4))] ~ x[-which.max(hatvalues(f4))])
abline(fit5, col="blue")
??hatvalues
influence.measures(f4)
maxinf <- which.max(influence.measures(f4))
maxinf <- [which.max(influence.measures(f4))]
maxinf <- (influence.measures(f4))[max]
maxinf <- apply(influence.measures(f4), max)
influence.measures(f4)
mf4 <- max(influence.measures(f4))
mf4 <- max(unlist(influence.measures(f4)))
maxhv <- hatvalues(f4)[which.max(hatvalues(f4))]
mf4 <- max(unlist(influence.measures(f4)))
??unlist
mf4 <- max(unlist(influence.measures(f4), recursive = TRUE))
influence.measures(f4)
influence.measures(f4)[5]
influence.measures(f4[5])
influence.measures(f4)[5]
influence.measures((f4),[5])
influence.measures((f4)[5])
influence.measures(f4)[which.max(hatvalues())]
influence.measures(f4)
plot(x, y, pch=12)
abline(f4, col="green")
fit5 <- lm(y[-which.max(hatvalues(f4))] ~ x[-which.max(hatvalues(f4))])
abline(fit5, col="magenta")
x <- c(0.586, 0.166, -0.042, -0.614, 11.72)
y <- c(0.549, -0.026, -0.127, -0.751, 1.344)
f4 <- lm(y ~ x)
hatvalues(f4)
influence.measures(f4)
maxhv <- hatvalues(f4)[which.max(hatvalues(f4))]
maxhv
f5 <- lm(y ~ x)
influence.measures(f5)
??im
infm <- influence.measures(f5)
infm
inflm <- influence.measures(f5)
inflm
maxb <- inflm[which.max(abs(inflm[,"hat"])),"dfb.x"]
maxb
f5 <- lm(y ~ x)
inflm <- influence.measures(f5)
inflm
maxb <- inflm[which.max(abs(inflm[,"hat"])),"dfb.x"]
maxb <- as.matrix(inflm)[which.max(inflm["dfb.x"])]
maxb <- as.matrix(abs(inflm))[which.max(inflm["dfb.x"])]
maxb <- as.matrix(inflm))[which.max(abs(inflm["dfb.x"]))]
maxb <- as.matrix(inflm))[which.max(abs(inflm)["dfb.x"])]
maxb <- as.matrix(inflm))[which.max(abs(inflm))["dfb.x"]
maxb <- as.matrix(inflm))[which.max(abs(inflm))["dfb.x")]
inflm <- influence.measures(f5)
inflm
r <- range(inflm[2])
r
r <- range(inflm[,2])
r <- range(inflm)[,2]
r <- range(inflm[,2])
inflm[,2]
inflm[2]
inflm <- influence.measures(f5)
inflm[2]
inflm <- influence.measures(f5)
inflm
n <- as.numeric(inflm)
n <- as.numeric(unlist(inflm))
#    -.00134
n
n <- as.numeric(unlist(inflm))
n
n <- as.numeric(unlist(inflm))[,2]
n
im <- influence.measures(f5)
im
im <- influence.measures(f5)[1:6]
im
im <- influence.measures(f5)[1:5]
im
im <- influence.measures(f5$residuals)
im
im1 <- influence.measures(f5)[,c(1:5)]
im1
im1 <- influence.measures(f5)[ ,c(1:5)]
im1 <- influence.measures(f5)[ ,-6]
im1 <- influence.measures(f5)[-6]
im1
f5
summary(f5)
str(f5)
hatvalues(f5)
im1 <- influence.measures(f5[-6])
im1 <- influence.measures(f5[,-6])
im1 <- influence.measures(f5)
im1
im1[,2]
m <- lapply(im1, max)[,2]
m <- lapply(im1, max)
m <- lapply(im1, max("dfb,x"))
m <- lapply(im1[,2], max)
m <- lapply(im1[2], max)
m
m <- lapply(im1$dfb.x, max)
m
im <- influence.measures(f5)
f5 <- lm(y ~ x)
hatvalues(f5)
im <- influence.measures(f5)
im
im2 <- stack(im)
im2 <- stack(im)[1]
im <- stack(influence.measures(f5))
im <- influence.measures(f5)
dfbetas(f5)[,2]
dfbetas(f5)[,2][which.max(dfbetas(f5)[,2])]
hatvalues(f5)
dfbetas(f5)[which.max(dfbetas(f5)[,2])]
(f5)[which.max(dfbetas(f5)[,2])]
[which.max(dfbetas(f5)[,2])]
f5[which.max(dfbetas(f5)[,2])]
dfbetas(f5)[which.max(dfbetas(f5)[,2])]
dfbetas(f5)[which.max(abs(dfbetas(f5))[,2])]
#    -.00134
dfbetas(f5)[which.max(abs(dfbetas(f5))[,2])]
f6 <- abs(influence.measures(f5))
f6 <- influence.measures(abs(f5))
f6 <- influence.measures(f5)
f6 <- abs(f6)
f6 <- abs(f6)[,1:6]
f6 <- abs(f6)[,1:5]
f6 <- f6[,c(1:6)]
f6 <- f6[,c(1:5)]
f6 <- f6[,1:5]
f6 <- f6[1:5]
f6
dfbetas(f6)[which.max(dfbetas(f6))[,2])]
dfbetas(f6)[which.max(dfbetas(f6))[2])]
dfbetas(f6)[which.max(dfbetas(f6))][2]
f6 <- influence.measures(f5)
f6
f6 <- f6[-6]
f6
f6 <- f6[,-6]
f6
f6 <- influence.measures(f5)
x <- c(0.586, 0.166, -0.042, -0.614, 11.72)
y <- c(0.549, -0.026, -0.127, -0.751, 1.344)
# Give the slope dfbeta for the point with the highest hat value.
require(dplyr)
f5 <- lm(y ~ x)
f6 <- influence.measures(f5)
f6
f7 <- as.vector(f6[5])
f7
dfbetas(f5)
xmax <- apply(dfbetas(f5)[2])
xmax <- apply(dfbetas(f5)[2], max)
xmax <- apply(dfbetas(f5$x, max)
xmax <- apply(dfbetas(f5$x), max)
xmax <- apply(dfbetas(f5), max)[2]
xmax <- apply(dfbetas(f5), max)[,2]
xmax <- dfbetas(apply(f5, max))
xmax <- (apply(f5, max))
xmax <- apply(f5, max)
xmax <- apply(f5[,2], max)
xmax <- apply(f5$x, max)
f5 <- lm(y ~ x)
dfbetas(f5)[,2]
max(dfbetas(f5)[,2])
which.max(dfbetas(f5)[,2])
dfbetas(f5)[which.max(dfbetas(f5)[,2])]
dfbetas(f5)[which.max(abs(f5))[,2])]
[which.max(abs(f5))[,2])]
[which.max(f5)[,2])]
which.max(f5)[,2])
which.max(f5)[,2]
influence.measures(f5)
dfbeta(f5)[,2]
dfbetas(f5)[which(hatvalues(f5)==max(hatvalues(f5))),2]
x <- c(0.586, 0.166, -0.042, -0.614, 11.72)
y <- c(0.549, -0.026, -0.127, -0.751, 1.344)
set.seed(4567)
z <- rnorm(5)
#
f8 <- lm(y ~ x)
fz <- lm(y ~ x + z)
#
coef(summary(f8))
coef(summary(fz))
f8 <- lm(y ~ x)
fz <- lm(y ~ x + z)
#
coef(summary(f8))
#
coef(summary(fz))
set.seed(3579)
z <- rnorm(5)
#
f8 <- lm(y ~ x)
fz <- lm(y ~ x + z)
#
coef(summary(f8))
#
coef(summary(fz))
x <- c(0.586, 0.166, -0.042, -0.614, 11.72)
y <- c(0.549, -0.026, -0.127, -0.751, 1.344)
set.seed(3579)
z <- rnorm(7)
#
f8 <- lm(y ~ x)
fz <- lm(y ~ x + z)
#
coef(summary(f8))
#
coef(summary(fz))
#
x <- c(0.586, 0.166, -0.042, -0.614, 11.72)
y <- c(0.549, -0.026, -0.127, -0.751, 1.344)
set.seed(3579)
z <- rnorm(7)
#
f8 <- lm(y ~ x)
fz <- lm(y ~ x + z)
fz <- lm(y ~ I(x + z))
fz <- lm(y ~ (x + z))
fz <- lm(y ~ x + z)
z <- rnorm(5)
#
f8 <- lm(y ~ x)
fz <- lm(y ~ x + z)
#
coef(summary(f8))
#
coef(summary(fz))
#
swirl()
swirl
install.packages("swirl")
library(swirl)
swirl()
dim(mtcars)
setwd("~/Desktop/Coursera_R/7_Regression Models/RM_proj_MPG_MotorTrendData")
